---
import Layout from "src/layouts/Layout.astro";
import { getCollection } from "astro:content";
import { css } from "styled-system/css";

const allWorks = await getCollection("works");

const mainPageStyles = css({
  width: "full",
  maxWidth: "1200px",
  margin: "0 auto",
  padding: { base: "4", md: "6" },
  display: "flex",
  flexDirection: "column",
  gap: { base: "6", md: "8" },
});

const pageTitleStyles = css({
  fontSize: { base: "2xl", md: "3xl" },
  fontWeight: "bold",
  textAlign: "center",
  color: "token(colors.gray.800)",
  marginBottom: { base: "4", md: "6" },
  letterSpacing: "tight",
});

const worksGridStyles = css({
  display: "grid",
  gridTemplateColumns: "repeat(auto-fill, minmax(min(100%, 300px), 1fr))",
  gap: { base: "4", md: "6" },
  listStyle: "none",
  padding: "0",
});

const workCardStyles = css({
  display: "flex",
  flexDirection: "column",
  border: "1px solid token(colors.gray.200)",
  borderRadius: "lg",
  overflow: "hidden",
  textDecoration: "none",
  color: "inherit",
  backgroundColor: "token(colors.white)",
  boxShadow: "md",
  transition:
    "box-shadow 0.3s ease, transform 0.2s ease, border-color 0.2s ease",
  _hover: {
    boxShadow: "xl",
    transform: "translateY(-4px)",
    borderColor: "token(colors.blue.400)",
  },
});

const workImageContainerStyles = css({
  width: "100%",
  height: "200px",
  overflow: "hidden",
});

const workImageStyles = css({
  width: "100%",
  height: "100%",
  objectFit: "cover",
  transition: "transform 0.3s ease-out",
  _hover: {
    transform: "scale(1.05)",
  },
});

const workContentStyles = css({
  padding: "1rem",
  display: "flex",
  flexDirection: "column",
  flexGrow: "1",
});

const workTitleStyles = css({
  fontSize: "lg",
  fontWeight: "semibold",
  color: "token(colors.gray.700)",
  marginBottom: "0.5rem",
  transition: "color 0.2s ease-in-out",
  _hover: {},
});

const workDescriptionStyles = css({
  fontSize: "sm",
  color: "token(colors.gray.600)",
  marginBottom: "0.75rem",
  flexGrow: "1",
});

const workTagsContainerStyles = css({
  marginTop: "auto",
  paddingTop: "0.5rem",
});

const workTagStyles = css({
  display: "inline-block",
  backgroundColor: "token(colors.blue.100)",
  color: "token(colors.blue.800)",
  padding: "0.25rem 0.75rem",
  borderRadius: "full",
  fontSize: "xs",
  fontWeight: "medium",
  marginRight: "0.5rem",
  marginBottom: "0.5rem",
});

const noWorksMessageStyles = css({
  textAlign: "center",
  color: "token(colors.gray.500)",
  padding: "2rem",
  fontSize: "lg",
});
---

<Layout title="My Works - Portfolio">
  <main class={mainPageStyles}>
    <h1 class={pageTitleStyles}>Explore My Portfolio</h1>

    {
      allWorks.length === 0 ? (
        <p class={noWorksMessageStyles}>
          It looks like there are no works to display at the moment. Please
          check back soon!
        </p>
      ) : (
        <div class={worksGridStyles}>
          {allWorks.map((work) => (
            <a
              href={`/works/${work.slug}`}
              class={workCardStyles}
              aria-label={`View details for ${work.data.title}`}
            >
              <div class={workImageContainerStyles}>
                <img
                  src={work.data.image}
                  alt={`Thumbnail for ${work.data.title}`}
                  class={workImageStyles}
                />
              </div>
              <div class={workContentStyles}>
                <h2 class={workTitleStyles}>{work.data.title}</h2>
                <p class={workDescriptionStyles}>
                  {work.data.description.length > 100
                    ? work.data.description.slice(0, 97) + "..."
                    : work.data.description}
                </p>
                <div class={workTagsContainerStyles}>
                  {work.data.tags.map((tag) => (
                    <span class={workTagStyles}>{tag}</span>
                  ))}
                </div>
              </div>
            </a>
          ))}
        </div>
      )
    }
  </main>
</Layout>
