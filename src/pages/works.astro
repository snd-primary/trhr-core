---
import Layout from "src/layouts/Layout.astro";
import { getCollection } from "astro:content";
import { css } from "styled-system/css";
import { Image } from "astro:assets";
import Tag from "src/components/ui/content/Tag.astro";

const allWorks = await getCollection("works");

const mainPageStyles = css({
  width: "full",
  margin: "0 auto",
  padding: { base: "4", md: "6" },
  display: "flex",
  flexDirection: "column",
  gap: { base: "6", md: "8" },
});

const pageTitleStyles = css({
  fontSize: { base: "2xl", md: "3xl" },
  fontWeight: "bold",
  textAlign: "center",
  marginBottom: { base: "4", md: "6" },
  letterSpacing: "tight",
});

const worksGridStyles = css({
  display: "grid",
  gridTemplateColumns: "1fr",
  md: { gridTemplateColumns: "1fr 1fr 1fr" },
  gap: { base: "4", md: "4" },
  listStyle: "none",
  padding: "4",
});

const workCardStyles = css({
  display: "grid",
  gridTemplateColumns: "1fr",
  gridTemplateRows: "1fr 0.5fr",
  borderRadius: "3xl",
  overflow: "hidden",
  textDecoration: "none",
  boxShadow: "none",
  position: "relative",
  border: "1px solid token(colors.border)",
  transition:
    "box-shadow 0.3s ease, transform 0.2s ease, border-color 0.2s ease",
});

const workImageContainerStyles = css({
  width: "full",
  aspectRatio: "video",
  overflow: "hidden",
});

const workImageStyles = css({
  width: "full",
  height: "full",
  objectFit: "cover",
  transition: "transform 0.3s ease-out",
});

const workContentStyles = css({
  padding: "1rem",
  display: "flex",
  flexDirection: "column",
  flexGrow: "1",
});

const workTitleStyles = css({
  fontSize: "lg",
  fontWeight: "semibold",
  marginBottom: "0.5rem",
  transition: "color 0.2s ease-in-out",
  _hover: {},
});

const workDescriptionStyles = css({
  fontSize: "sm",
  marginBottom: "0.75rem",
  flexGrow: "1",
});

const workTagsContainerStyles = css({
  display: "flex",
  gap: "2",
});

const noWorksMessageStyles = css({
  textAlign: "center",
  color: "token(colors.gray.500)",
  padding: "2rem",
  fontSize: "lg",
});
---

<Layout title="My Works - Portfolio">
  <main class={mainPageStyles}>
    <h1 class={pageTitleStyles}>Explore My Portfolio</h1>

    {
      allWorks.length === 0 ? (
        <p class={noWorksMessageStyles}>
          It looks like there are no works to display at the moment. Please
          check back soon!
        </p>
      ) : (
        <div class={worksGridStyles}>
          {allWorks.map((work) => (
            <a
              href={`/works/work1`}
              class={workCardStyles}
              aria-label={`View details for ${work.data.title}`}
            >
              <div class={workImageContainerStyles}>
                <Image
                  src={work.data.image}
                  alt={`Thumbnail for ${work.data.title}`}
                  class={workImageStyles}
                />
              </div>
              <div class={workContentStyles}>
                <h2 class={workTitleStyles}>{work.data.title}</h2>
                <p class={workDescriptionStyles}>
                  {work.data.description.length > 100
                    ? work.data.description.slice(0, 97) + "..."
                    : work.data.description}
                </p>
                <div class={workTagsContainerStyles}>
                  {work.data.tags.map((tag) => (
                    <Tag tag={tag} />
                  ))}
                </div>
              </div>
            </a>
          ))}
        </div>
      )
    }
  </main>
</Layout>
